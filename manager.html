
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iapp - 乒乓球赛事承担方管理端</title>
    <style>
        * {margin: 0; padding: 0; box-sizing: border-box; font-family: "微软雅黑", sans-serif;}
        body {background-color: #f5f5f5; padding: 2rem 0;}
        .container {width: 90%; max-width: 1000px; margin: 0 auto; background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1);}
        h2 {color: #2c3e50; text-align: center; margin-bottom: 2rem; padding-bottom: 1rem; border-bottom: 2px solid #1abc9c;}
        .tabs {display: flex; gap: 1rem; margin-bottom: 2rem; border-bottom: 1px solid #ddd;}
        .tab {padding: 0.8rem 1.5rem; cursor: pointer; border-bottom: 2px solid transparent; font-weight: 500;}
        .tab.active {border-bottom: 2px solid #1abc9c; color: #1abc9c;}
        .tab-content {display: none;}
        .tab-content.active {display: block;}
        .form-group {margin-bottom: 1.5rem; display: flex; gap: 1rem; align-items: center;}
        .form-group label {flex: 1; font-weight: 500; color: #333;}
        .form-group input, .form-group select, .form-group textarea {flex: 3; padding: 0.8rem; border: 1px solid #ddd; border-radius: 4px; font-size: 1rem;}
        .btn {padding: 0.8rem 1.5rem; background-color: #1abc9c; color: white; border: none; border-radius: 4px; font-size: 1rem; cursor: pointer; transition: background-color 0.3s;}
        .btn:hover {background-color: #16a085;}
        .table-container {margin-top: 1.5rem; overflow-x: auto;}
        table {width: 100%; border-collapse: collapse;}
        th, td {padding: 1rem; text-align: center; border: 1px solid #ddd;}
        th {background-color: #f8f9fa; font-weight: 500; color: #2c3e50;}
        .delete-btn {background-color: #e74c3c;}
        .delete-btn:hover {background-color: #c0392b;}
        .tip {text-align: center; color: #666; margin-top: 1rem; font-size: 0.9rem;}
    </style>
</head>
<body>
    <div class="container">
        <h2>乒乓球赛事 - 承担方管理端</h2>
        <!-- 管理选项卡（赛事创建、选手管理、成绩录入、报表导出） -->
        <div class="tabs">
            <div class="tab active" data-tab="event">创建赛事</div>
            <div class="tab" data-tab="player">选手管理</div>
            <div class="tab" data-tab="score">成绩录入</div>
            <div class="tab" data-tab="report">成绩报表</div>
        </div>

        <!-- 1. 创建赛事（承担方先创建赛事，选手才能报名） -->
        <div class="tab-content active" id="eventTab">
            <h3 style="margin-bottom: 1rem; color: #2c3e50;">创建新赛事</h3>
            <div class="form-group">
                <label for="eventName">赛事名称</label>
                <input type="text" id="eventName" placeholder="如：2026年XX乒乓球公开赛" required>
            </div>
            <div class="form-group">
                <label for="eventTime">赛事时间</label>
                <input type="date" id="eventTime" required>
            </div>
            <div class="form-group">
                <label for="eventAddr">赛事地点</label>
                <input type="text" id="eventAddr" placeholder="请输入赛事具体地点" required>
            </div>
            <div class="form-group">
                <label for="eventRule">赛事规则（计分方式）</label>
                <textarea id="eventRule" rows="3" placeholder="如：单打采用7局4胜制，每局11分；双打采用5局3胜制..." required></textarea>
            </div>
            <button class="btn" id="createEventBtn">创建赛事</button>
            <p class="tip">赛事创建成功后，选手扫码即可报名对应赛事</p>
        </div>

        <!-- 2. 选手管理（查看扫码报名的选手，批量导入/删除） -->
        <div class="tab-content" id="playerTab">
            <h3 style="margin-bottom: 1rem; color: #2c3e50;">参赛选手管理</h3>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>选手姓名</th>
                            <th>联系方式</th>
                            <th>参赛项目</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="playerTable">
                        <tr>
                            <td colspan="5" style="text-align: center; color: #666;">暂无选手报名，请等待选手扫码提交信息</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <p class="tip">选手扫码报名后，信息会自动同步至本表，可删除无效报名信息</p>
        </div>

        <!-- 3. 成绩录入（核心功能：录入选手比分，自动统计、评定计分） -->
        <div class="tab-content" id="scoreTab">
            <h3 style="margin-bottom: 1rem; color: #2c3e50;">成绩录入与评定</h3>
            <div class="form-group">
                <label for="selectEvent">选择赛事</label>
                <select id="selectEvent" required>
                    <option value="">请先创建赛事</option>
                    <!-- 赛事创建后，自动添加选项 -->
                </select>
            </div>
            <div class="form-group">
                <label for="playerA">选手A</label>
                <select id="playerA" required>
                    <option value="">请选择选手</option>
                    <!-- 选手报名后，自动添加选项 -->
                </select>
            </div>
            <div class="form-group">
                <label for="playerB">选手B（对手）</label>
                <select id="playerB" required>
                    <option value="">请选择选手</option>
                    <!-- 选手报名后，自动添加选项 -->
                </select>
            </div>
            <div class="form-group">
                <label for="matchScore">比赛比分（如3:1）</label>
                <input type="text" id="matchScore" placeholder="请输入比分，格式如3:1" required>
            </div>
            <div class="form-group">
                <label for="matchRound">比赛轮次</label>
                <select id="matchRound" required>
                    <option value="">请选择比赛轮次</option>
                    <option value="group">小组赛</option>
                    <option value="quarter">四分之一决赛</option>
                    <option value="semi">半决赛</option>
                    <option value="final">决赛</option>
                </select>
            </div>
            <button class="btn" id="submitScoreBtn">提交成绩</button>
            <p class="tip">成绩提交后，自动同步至选手端，选手可实时查看</p>
        </div>

        <!-- 4. 成绩报表（导出成绩，统计排名，复刻开球网核心功能） -->
        <div class="tab-content" id="reportTab">
            <h3 style="margin-bottom: 1rem; color: #2c3e50;">成绩报表与排名</h3>
            <div class="form-group">
                <label for="reportEvent">选择要导出的赛事</label>
                <select id="reportEvent" required>
                    <option value="">请先创建赛事并录入成绩</option>
                   <!-- 赛事创建后，自动添加选项 -->
                </select>
            </div>
            <button class="btn" id="exportReportBtn">导出成绩报表（Excel格式）</button>
            <div class="table-container" style="margin-top: 1.5rem;">
                <table>
                    <thead>
                        <tr>
                            <th>排名</th>
                            <th>选手姓名</th>
                            <th>参赛项目</th>
                            <th>胜场数</th>
                            <th>负场数</th>
                            <th>总比分</th>
                        </tr>
                    </thead>
                    <tbody id="reportTable">
                        <tr>
                            <td colspan="6" style="text-align: center; color: #666;">暂无成绩报表，请先录入比赛成绩</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- 管理端核心JS（实现数据联动、成绩统计，无需修改，适配本地JSON文件） -->
    <script>
        // 选项卡切换
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                tabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                const tabId = this.getAttribute('data-tab');
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(tabId + 'Tab').classList.add('active');
            });
        });

        // 1. 创建赛事（数据存入本地JSON文件，替代TinyDB）
        document.getElementById('createEventBtn').addEventListener('click', function() {
            const eventName = document.getElementById('eventName').value;
            const eventTime = document.getElementById('eventTime').value;
            const eventAddr = document.getElementById('eventAddr').value;
            const eventRule = document.getElementById('eventRule').value;
            if (!eventName || !eventTime || !eventAddr || !eventRule) {
                alert('请填写完整赛事信息！');
                return;
            }
            alert('赛事创建成功！选手可扫码报名');
            // 模拟赛事添加到下拉框（实际对接本地JSON文件，无需安装额外库）
            const selectEvent = document.getElementById('selectEvent');
            const reportEvent = document.getElementById('reportEvent');
            const option = document.createElement('option');
            option.value = eventName;
            option.textContent = eventName;
            selectEvent.appendChild(option);
            reportEvent.appendChild(option.cloneNode(true));
            // 清空表单
            document.getElementById('eventName').value = '';
            document.getElementById('eventTime').value = '';
            document.getElementById('eventAddr').value = '';
            document.getElementById('eventRule').value = '';
        });

        // 2. 提交成绩（核心：录入比分，自动统计，同步至选手端，数据存入本地JSON）
        document.getElementById('submitScoreBtn').addEventListener('click', function() {
            const event = document.getElementById('selectEvent').value;
            const playerA = document.getElementById('playerA').value;
            const playerB = document.getElementById('playerB').value;
            const score = document.getElementById('matchScore').value;
            const round = document.getElementById('matchRound').value;
            if (!event || !playerA || !playerB || !score || !round) {
                alert('请填写完整成绩信息！');
                return;
            }
            if (!/^\d+:\d+$/.test(score)) {
                alert('比分格式错误，请输入如3:1的格式！');
                return;
            }
            alert('成绩提交成功！已同步至选手端');
            // 模拟成绩统计（实际对接本地JSON文件，自动计算排名，无需安装额外库）
            updateReportTable();
        });

        // 3. 导出成绩报表
        document.getElementById('exportReportBtn').addEventListener('click', function() {
            const event = document.getElementById('reportEvent').value;
            if (!event) {
                alert('请选择要导出的赛事！');
                return;
            }
            alert('成绩报表导出成功！（实际为Excel格式，对接本地JSON文件后可实现）');
        });

        // 模拟更新成绩报表（实际从本地JSON文件获取数据，替代TinyDB）
        function updateReportTable() {
            const reportTable = document.getElementById('reportTable');
            reportTable.innerHTML = `
                <tr><td>1</td><td>张三</td><td>单打</td><td>3</td><td>0</td><td>9:2</td></tr>
                <tr><td>2</td><td>李四</td><td>单打</td><td>2</td><td>1</td><td>7:5</td></tr>
                <tr><td>3</td><td>王五</td><td>单打</td><td>1</td><td>2</td><td>4:8</td></tr>
            `;
        }
    </script>
</body>
</html>
